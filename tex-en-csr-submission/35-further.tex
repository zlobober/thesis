\section{Extension to the weighted case}

Algorithm \ref{alg:n7} can be easily generalized to the case of a graph $G = (V, E)$ endowed with positive edge weigths $w : E \rightarrow \mathbb{R}_+$ by exploiting the fact that the algorithm only compares the distances between the pairs of vertices and performs arithmetic operations on them (in contrast to Algorithm \ref{alg:n6} where distances become the parameter of a bilinear form).

The complete pseudocode of the algorithm for the weighted case is provided in the Appendix. We state  the result of this section as following:

\begin{theorem}
Given graph $G = (V, E)$ with positive edge weights $w$, Algorithm \ref{alg:n7w} computes the values of predicate $2DSP(s_1, t_1, s_2, t_2)$ for all quadruples of $(s_1, t_1, s_2, t_2)$ in $\OO(|V|^7)$ time and $\OO(|V|^5)$ memory. 
\end{theorem}
